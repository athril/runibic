context("Discretize Matrix")

test_that("Discretize the matrix", {
  A = matrix(c(7.167073, 7.101113, 7.165570, 7.232143, 7.261930, 7.246897, 7.049703, 7.127320, 7.094090, 7.150517, 7.139130, 7.286433, 7.373734, 7.288830, 7.119480, 7.400880, 7.399720, 7.466070, 7.357207, 0.000000, 
            7.182337, 7.376997, 7.300426, 7.202577, 7.338627, 7.270780, 7.352423, 7.256027, 7.280143, 7.318213, 7.338893, 7.240340, 7.270033, 7.338696, 7.337783, 7.202510, 7.092427, 7.248783, 7.129027, 7.137233, 
            7.895460, 7.965483, 7.859897, 7.927880, 7.856357, 7.901167, 7.799597, 7.935540, 7.870747, 7.797667, 7.935753, 7.915117, 8.107863, 8.168087, 8.074964, 7.949584, 8.417903, 8.207853, 8.150977, 8.160847, 
            6.890737, 6.944740, 6.868780, 6.956447, 6.833797, 6.850303, 6.948657, 6.844857, 6.946533, 6.829017, 6.975927, 6.931650, 7.176737, 7.148893, 7.083810, 6.916830, 7.180410, 7.158950, 7.154783, 7.107117, 
            9.164957, 9.198107, 9.203867, 9.245490, 9.176927, 9.015600, 9.241633, 9.023376, 9.152220, 9.126480, 9.173250, 9.275904, 9.290140, 9.414396, 9.316103, 8.944000, 9.196600, 9.249830, 9.197193, 9.205010, 
            9.084076, 8.934143, 9.011817, 9.014307, 9.022484, 8.952700, 8.894577, 8.737336, 8.975133, 8.831717, 8.744166, 8.751040, 8.406997, 8.580800, 8.402066, 8.785787, 8.306923, 8.263603, 8.638989, 8.336777, 
            8.027933, 8.083527, 8.126837, 8.034317, 8.146403, 7.967420, 8.076934, 7.870820, 8.045333, 8.204456, 8.049577, 8.113297, 7.340653, 7.681473, 7.534687, 7.929400, 7.302177, 7.312346, 7.060540, 7.187243, 
            7.382270, 7.497927, 7.573760, 7.312710, 7.441167, 7.354113, 7.458500, 7.155380, 7.469000, 7.502753, 7.530160, 7.534997, 6.591593, 7.028910, 6.929867, 7.438200, 6.617064, 6.719437, 6.377803, 6.541087, 
            7.174233, 7.301720, 7.366040, 7.171737, 7.397286, 7.119043, 7.229897, 7.000880, 7.211300, 7.367887, 7.304574, 7.318670, 6.400804, 6.770437, 6.645427, 7.146093, 6.221217, 6.359880, 6.058733, 6.347833, 
            6.358233, 6.477207, 6.616577, 6.570800, 6.571417, 6.427990, 6.549757, 6.244980, 6.451517, 6.481363, 6.432810, 6.526740, 5.785233, 6.299714, 5.966720, 6.496907, 5.647967, 5.715173, 5.496633, 5.626937, 
            8.162883, 8.125690, 8.119000, 8.094486, 8.095113, 8.040076, 8.148670, 7.866903, 8.078900, 8.130840, 8.131857, 8.061003, 7.855200, 7.766077, 7.819897, 8.136347, 7.849990, 7.830057, 8.059656, 7.975753, 
            10.225567, 10.431033, 10.382566, 10.402400, 10.348766, 10.520133, 10.421600, 10.075077, 10.336766, 10.309700, 10.344800, 10.297033, 10.032907, 10.127546, 10.074393, 10.576333, 10.087733, 10.063634, 10.270933, 10.198467, 
            11.829433, 11.874300, 11.824166, 11.813700, 11.892467, 11.605866, 11.944100, 11.794900, 11.874300, 11.996100, 11.863033, 11.802400, 11.492900, 11.388967, 11.536567, 11.869300, 11.317433, 11.364667, 11.462000, 11.300800, 
            10.269400, 10.366100, 10.308300, 10.358767, 10.385799, 10.310034, 10.401867, 10.330733, 10.421033, 10.411366, 10.268633, 10.309577, 9.938290, 9.626730, 9.953160, 10.970500, 9.770000, 9.787770, 9.895070, 9.723157, 
            10.275666, 10.320000, 10.419900, 10.372633, 10.279233, 10.509466, 10.266700, 10.714334, 10.267266, 10.339800, 10.187113, 10.264000, 10.123767, 9.990920, 10.147367, 10.713700, 9.943776, 9.887493, 9.858561, 9.916626, 
            8.090034, 7.928383, 8.117784, 7.957953, 8.118609, 8.297266, 7.921357, 7.443284, 8.108177, 8.008707, 8.046746, 8.316926, 8.493217, 8.884113, 8.640324, 8.737066, 9.030480, 8.838200, 8.992746, 8.954737, 
            8.991690, 8.743656, 9.162970, 9.005800, 9.052337, 9.277257, 9.042024, 8.635603, 9.085959, 9.041093, 9.063967, 9.241317, 9.928026, 10.188956, 9.989080, 9.692906, 10.091454, 9.971650, 10.044713, 10.065434, 
            12.806600, 12.889300, 12.997399, 12.800767, 13.000834, 12.950300, 13.028800, 12.340333, 13.019700, 12.925134, 12.996766, 12.709733, 12.779834, 12.686300, 12.648733, 12.671100, 12.547566, 12.504400, 12.544200, 12.603400, 
            12.164866, 12.254733, 12.426200, 12.200600, 12.405733, 12.197866, 12.439834, 12.080400, 12.363800, 12.341800, 12.383133, 12.156300, 12.351167, 12.285900, 12.254900, 12.446300, 12.260734, 12.243900, 12.277367, 12.300700),nrow=19,byrow=TRUE)
  B = discretize(A) 
  result = matrix(c(11, 17, 12, 10, 8, 9, 19, 15, 18, 13, 14, 7, 4, 6, 16, 2, 3, 1, 5, 20, 
                    17, 1, 8, 15, 5, 10, 2, 12, 9, 7, 3, 14, 11, 4, 6, 16, 20, 13, 19, 18, 
                    15, 8, 17, 12, 18, 14, 19, 11, 16, 20, 10, 13, 6, 3, 7, 9, 1, 2, 5, 4, 
                    15, 12, 16, 9, 19, 17, 10, 18, 11, 20, 8, 13, 2, 5, 7, 14, 1, 3, 4, 6, 
                    15, 10, 9, 6, 13, 19, 7, 18, 16, 17, 14, 4, 3, 1, 2, 20, 12, 5, 11, 8, 
                    1, 7, 4, 3, 2, 6, 8, 13, 5, 9, 12, 11, 16, 15, 17, 10, 19, 20, 14, 18, 
                    10, 5, 3, 9, 2, 11, 6, 13, 8, 1, 7, 4, 16, 14, 15, 12, 18, 17, 20, 19, 
                    10, 5, 1, 12, 8, 11, 7, 13, 6, 4, 3, 2, 18, 14, 15, 9, 17, 16, 20, 19, 
                    9, 6, 3, 10, 1, 12, 7, 13, 8, 2, 5, 4, 16, 14, 15, 11, 19, 17, 20, 18, 
                    12, 8, 1, 3, 2, 11, 4, 14, 9, 7, 10, 5, 16, 13, 15, 6, 18, 17, 20, 19, 
                    1, 6, 7, 9, 8, 13, 2, 15, 10, 5, 4, 11, 16, 20, 19, 3, 17, 18, 12, 14, 
                    13, 3, 6, 5, 7, 2, 4, 17, 9, 10, 8, 11, 20, 15, 18, 1, 16, 19, 12, 14, 
                    8, 4, 9, 10, 3, 13, 2, 12, 4, 1, 7, 11, 15, 17, 14, 6, 19, 18, 16, 20, 
                    12, 6, 11, 7, 5, 9, 4, 8, 2, 3, 13, 10, 15, 20, 14, 1, 18, 17, 16, 19, 
                    9, 7, 4, 5, 8, 3, 11, 1, 10, 6, 13, 12, 15, 16, 14, 2, 17, 19, 20, 18, 
                    14, 18, 12, 17, 11, 10, 19, 20, 13, 16, 15, 9, 8, 4, 7, 6, 1, 5, 2, 3, 
                    18, 19, 11, 17, 14, 9, 15, 20, 12, 16, 13, 10, 7, 1, 5, 8, 2, 6, 4, 3, 
                    9, 8, 4, 10, 3, 6, 1, 20, 2, 7, 5, 12, 11, 13, 15, 14, 17, 19, 18, 16, 
                    18, 14, 3, 16, 4, 17, 2, 20, 6, 8, 5, 19, 7, 10, 13, 1, 12, 15, 11, 9), nrow=19,byrow=TRUE)

    expect_that( B, is_a("matrix"))
    expect_that( B, equals(result))
})
